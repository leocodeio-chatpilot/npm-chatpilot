{"version":3,"file":"index.umd.js","sources":["../src/index.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport { SiChatbot } from \"react-icons/si\";\r\nimport { GiCrossedBones } from \"react-icons/gi\";\r\nimport { IoSendSharp } from \"react-icons/io5\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { toast, Toaster } from \"react-hot-toast\";\r\nimport './styles.css';\r\n\r\nexport const Capitalize = ({ str }: { str: string }) => {\r\n  return str.charAt(0).toUpperCase() + str.slice(1);\r\n};\r\n\r\ninterface Message {\r\n  role: string;\r\n  content: string;\r\n}\r\n\r\nexport const ChatPilotBot = ({ \r\n  apiKey,\r\n  apiUrl = \"https://api.chatpilot.com\" \r\n}: { \r\n  apiKey: string;\r\n  apiUrl?: string;\r\n}) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [inputMessage, setInputMessage] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const handleSendMessage = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    if (!inputMessage.trim()) return;\r\n\r\n    const newMessage = { role: \"user\", content: inputMessage };\r\n    setMessages([...messages, newMessage]);\r\n    setInputMessage(\"\");\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const response = await fetch(`${apiUrl}/prompt`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${apiKey}`,\r\n        },\r\n        body: JSON.stringify({ messages: [...messages, newMessage] }),\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"Failed to get response\");\r\n\r\n      const data = await response.json();\r\n      setMessages((prev) => [...prev, { role: \"assistant\", content: data.response }]);\r\n    } catch (error) {\r\n      toast.error(\"Failed to get response\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"chatpilot-fixed chatpilot-bottom-4 chatpilot-right-4\">\r\n      <Toaster position=\"top-right\" />\r\n      {isOpen ? (\r\n        <div className=\"chatpilot-container\">\r\n          <div className=\"chatpilot-header\">\r\n            <div className=\"chatpilot-flex chatpilot-items-center chatpilot-gap-2\">\r\n              <SiChatbot className=\"chatpilot-w-6 chatpilot-h-6\" />\r\n              <span className=\"chatpilot-font-semibold\">ChatPilot</span>\r\n            </div>\r\n            <button \r\n              onClick={() => setIsOpen(false)}\r\n              className=\"chatpilot-p-2 chatpilot-rounded-full hover:chatpilot-bg-gray-100\"\r\n            >\r\n              <GiCrossedBones className=\"chatpilot-w-5 chatpilot-h-5\" />\r\n            </button>\r\n          </div>\r\n          \r\n          <div className=\"chatpilot-h-96 chatpilot-overflow-y-auto chatpilot-p-4\">\r\n            {messages.map((message, index) => (\r\n              <div\r\n                key={index}\r\n                className={`chatpilot-mb-4 chatpilot-flex ${\r\n                  message.role === \"user\" ? \"chatpilot-justify-end\" : \"chatpilot-justify-start\"\r\n                }`}\r\n              >\r\n                <div\r\n                  className={`chatpilot-max-w-[80%] chatpilot-rounded-lg chatpilot-p-3 ${\r\n                    message.role === \"user\"\r\n                      ? \"chatpilot-bg-blue-500 chatpilot-text-white\"\r\n                      : \"chatpilot-bg-gray-200\"\r\n                  }`}\r\n                >\r\n                  {message.content}\r\n                </div>\r\n              </div>\r\n            ))}\r\n            {isLoading && (\r\n              <div className=\"chatpilot-flex chatpilot-justify-start chatpilot-mb-4\">\r\n                <div className=\"chatpilot-bg-gray-200 chatpilot-rounded-lg chatpilot-p-3\">\r\n                  Typing...\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div ref={messagesEndRef} />\r\n          </div>\r\n\r\n          <form onSubmit={handleSendMessage} className=\"chatpilot-p-4 chatpilot-border-t\">\r\n            <div className=\"chatpilot-flex chatpilot-gap-2\">\r\n              <input\r\n                type=\"text\"\r\n                value={inputMessage}\r\n                onChange={(e) => setInputMessage(e.target.value)}\r\n                placeholder=\"Type your message...\"\r\n                className=\"chatpilot-flex-1 chatpilot-rounded-lg chatpilot-border chatpilot-p-2 chatpilot-focus:outline-none chatpilot-focus:ring-2 chatpilot-focus:ring-blue-500\"\r\n              />\r\n              <button\r\n                type=\"submit\"\r\n                disabled={isLoading}\r\n                className=\"chatpilot-bg-blue-500 chatpilot-text-white chatpilot-p-2 chatpilot-rounded-lg hover:chatpilot-bg-blue-600 chatpilot-transition-colors disabled:chatpilot-opacity-50\"\r\n              >\r\n                <IoSendSharp className=\"chatpilot-w-5 chatpilot-h-5\" />\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      ) : (\r\n        <button\r\n          onClick={() => setIsOpen(true)}\r\n          className=\"chatpilot-bg-blue-500 chatpilot-text-white chatpilot-p-4 chatpilot-rounded-full hover:chatpilot-bg-blue-600 chatpilot-transition-colors\"\r\n        >\r\n          <SiChatbot className=\"chatpilot-w-6 chatpilot-h-6\" />\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n};"],"names":["_ref","str","charAt","toUpperCase","slice","_ref2","apiKey","_ref2$apiUrl","apiUrl","_useState","useState","isOpen","setIsOpen","_useState2","messages","setMessages","_useState3","inputMessage","setInputMessage","_useState4","isLoading","setIsLoading","messagesEndRef","useRef","useEffect","_messagesEndRef$curre","current","scrollIntoView","behavior","React","createElement","className","Toaster","position","SiChatbot","onClick","GiCrossedBones","map","message","index","key","role","content","ref","onSubmit","e","preventDefault","trim","Promise","resolve","newMessage","concat","fetch","method","headers","Authorization","body","JSON","stringify","then","response","ok","Error","json","data","prev","_catch","toast","error","_finallyRethrows","_wasThrown","_result","reject","type","value","onChange","target","placeholder","disabled","IoSendSharp"],"mappings":"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"}