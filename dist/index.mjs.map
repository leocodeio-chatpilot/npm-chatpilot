{"version":3,"file":"index.mjs","sources":["../src/index.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { SiChatbot } from \"react-icons/si\";\r\nimport { GiCrossedBones } from \"react-icons/gi\";\r\nimport { IoSendSharp } from \"react-icons/io5\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { toast, Toaster } from \"react-hot-toast\";\r\n\r\nexport const Capitalize = ({ str }: { str: string }) => {\r\n  return str.charAt(0).toUpperCase() + str.slice(1);\r\n};\r\n\r\ninterface Message {\r\n  role: string;\r\n  content: string;\r\n}\r\n\r\nexport const ChatPilotBot = ({\r\n  apiKey,\r\n  apiUrl = \"https://api.chatpilot.com\",\r\n  xApiKey,\r\n}: {\r\n  apiKey: string;\r\n  xApiKey: string;\r\n  apiUrl?: string;\r\n}) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [inputMessage, setInputMessage] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const handleSendMessage = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    if (!inputMessage.trim()) return;\r\n\r\n    const newMessage = { role: \"user\", content: inputMessage };\r\n    setMessages([...messages, newMessage]);\r\n    setInputMessage(\"\");\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const response = await fetch(`${apiUrl}/prompt`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          \"x-api-key\": xApiKey,\r\n        },\r\n        body: JSON.stringify({\r\n          queryText: inputMessage,\r\n          apiKey: apiKey,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"Failed to get response\");\r\n\r\n      const data = await response.json();\r\n      setMessages((prev) => [\r\n        ...prev,\r\n        { role: \"assistant\", content: data.response },\r\n      ]);\r\n    } catch (error) {\r\n      toast.error(\"Failed to get response\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const styles = {\r\n    container: {\r\n      position: \"fixed\",\r\n      bottom: \"2rem\",\r\n      right: \"2rem\",\r\n      zIndex: 50,\r\n    },\r\n    chatContainer: {\r\n      maxWidth: \"25rem\",\r\n      maxHeight: \"35rem\",\r\n      backgroundColor: \"white\",\r\n      borderRadius: \"0.75rem\",\r\n      boxShadow: \"0 4px 6px rgba(0, 0, 0, 0.1)\",\r\n      overflow: \"hidden\",\r\n      zIndex: 50,\r\n    },\r\n    header: {\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      justifyContent: \"end\",\r\n      padding: \"0.75rem\",\r\n    },\r\n    closeButton: {\r\n      cursor: \"pointer\",\r\n      transition: \"transform 0.3s ease-in-out\",\r\n      \":hover\": {\r\n        transform: \"scale(1.25)\",\r\n      },\r\n    },\r\n    messagesContainer: {\r\n      height: \"20rem\",\r\n      overflowY: \"auto\",\r\n      padding: \"1rem\",\r\n    },\r\n    messageWrapper: (isUser: boolean) => ({\r\n      marginBottom: \"0.75rem\",\r\n      display: \"flex\",\r\n      justifyContent: isUser ? \"flex-end\" : \"flex-start\",\r\n    }),\r\n    message: (isUser: boolean) => ({\r\n      maxWidth: \"75%\",\r\n      borderRadius: \"1rem\",\r\n      padding: \"0.75rem 1rem\",\r\n      backgroundColor: isUser ? \"#3b82f6\" : \"#f3f4f6\",\r\n      color: isUser ? \"white\" : \"black\",\r\n    }),\r\n    noMessages: {\r\n      textAlign: \"center\",\r\n      color: \"#9ca3af\",\r\n    },\r\n    inputContainer: {\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      gap: \"0.5rem\",\r\n      padding: \"0.5rem\",\r\n      borderTop: \"1px solid #e5e7eb\",\r\n    },\r\n    input: {\r\n      flexGrow: 1,\r\n      padding: \"0.75rem\",\r\n      borderRadius: \"0.5rem\",\r\n      border: \"1px solid #e5e7eb\",\r\n      outline: \"none\",\r\n      \":focus\": {\r\n        borderColor: \"#3b82f6\",\r\n      },\r\n    },\r\n    sendButton: {\r\n      backgroundColor: \"#3b82f6\",\r\n      color: \"white\",\r\n      borderRadius: \"0.5rem\",\r\n      \":hover\": {\r\n        backgroundColor: \"#2563eb\",\r\n      },\r\n    },\r\n    chatButton: {\r\n      backgroundColor: \"#ef4444\",\r\n      color: \"white\",\r\n      padding: \"0.5rem\",\r\n      borderRadius: \"9999px\",\r\n      boxShadow: \"0 4px 6px rgba(0, 0, 0, 0.1)\",\r\n      \":hover\": {\r\n        backgroundColor: \"#dc2626\",\r\n      },\r\n    },\r\n    chatbotIcon: {\r\n      width: \"1.5rem\",\r\n      height: \"1.5rem\",\r\n    },\r\n    inputWrapper: {\r\n      display: \"flex\",\r\n      alignItems: \"center\",\r\n      gap: \"0.5rem\",\r\n      padding: \"0.5rem\",\r\n      borderTop: \"1px solid #e5e7eb\",\r\n    },\r\n  };\r\n\r\n  return (\r\n    <div style={styles.container as React.CSSProperties}>\r\n      <Toaster position=\"top-right\" />\r\n      {isOpen ? (\r\n        <div style={styles.chatContainer as React.CSSProperties}>\r\n          <div style={styles.header as React.CSSProperties}>\r\n            <button onClick={() => setIsOpen(false)} className=\"close-button\">\r\n              <GiCrossedBones\r\n                style={styles.closeButton as React.CSSProperties}\r\n              />\r\n            </button>\r\n          </div>\r\n\r\n          <div style={styles.messagesContainer as React.CSSProperties}>\r\n            {messages.map((message, index) => (\r\n              <div\r\n                key={index}\r\n                style={styles.messageWrapper(message.role === \"user\")}\r\n              >\r\n                <div style={styles.message(message.role === \"user\")}>\r\n                  {message.content}\r\n                </div>\r\n              </div>\r\n            ))}\r\n            {isLoading && (\r\n              <div style={styles.messageWrapper(false)}>\r\n                <div style={styles.message(false)}>Typing...</div>\r\n              </div>\r\n            )}\r\n            <div ref={messagesEndRef} />\r\n          </div>\r\n\r\n          <form\r\n            onSubmit={handleSendMessage}\r\n            style={styles.inputContainer as React.CSSProperties}\r\n          >\r\n            <div style={styles.inputWrapper as React.CSSProperties}>\r\n              <input\r\n                type=\"text\"\r\n                value={inputMessage}\r\n                onChange={(e) => setInputMessage(e.target.value)}\r\n                placeholder=\"Type your message...\"\r\n                style={styles.input as React.CSSProperties}\r\n              />\r\n              <button\r\n                type=\"submit\"\r\n                disabled={isLoading}\r\n                style={styles.sendButton as React.CSSProperties}\r\n              >\r\n                <IoSendSharp style={styles.sendButton as React.CSSProperties} />\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      ) : (\r\n        <button onClick={() => setIsOpen(true)} className=\"chat-button\">\r\n          <SiChatbot style={styles.chatbotIcon as React.CSSProperties} />\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n"],"names":["Capitalize","str","charAt","toUpperCase","slice","ChatPilotBot","apiKey","apiUrl","xApiKey","isOpen","setIsOpen","useState","messages","setMessages","inputMessage","setInputMessage","isLoading","setIsLoading","messagesEndRef","useRef","useEffect","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","styles","container","position","bottom","right","zIndex","chatContainer","maxWidth","maxHeight","backgroundColor","borderRadius","boxShadow","overflow","header","display","alignItems","justifyContent","padding","closeButton","cursor","transition","transform","messagesContainer","height","overflowY","messageWrapper","isUser","marginBottom","message","color","noMessages","textAlign","inputContainer","gap","borderTop","input","flexGrow","border","outline","borderColor","sendButton","chatButton","chatbotIcon","width","inputWrapper","React","createElement","style","Toaster","onClick","className","GiCrossedBones","map","index","key","role","content","ref","onSubmit","async","e","preventDefault","trim","newMessage","response","fetch","method","headers","body","JSON","stringify","queryText","ok","Error","data","json","prev","error","toast","type","value","onChange","target","placeholder","disabled","IoSendSharp","SiChatbot"],"mappings":"kRAOa,MAAAA,EAAaA,EAAGC,SACpBA,EAAIC,OAAO,GAAGC,cAAgBF,EAAIG,MAAM,GAQpCC,EAAeA,EAC1BC,SACAC,OAAAA,EAAS,4BACTC,cAMA,MAAOC,EAAQC,GAAaC,GAAS,IAC9BC,EAAUC,GAAeF,EAAoB,KAC7CG,EAAcC,GAAmBJ,EAAS,KAC1CK,EAAWC,GAAgBN,GAAS,GACrCO,EAAiBC,EAAuB,MAM9CC,EAAU,KAJaC,IAAKC,EAC1BA,OAAAA,EAAAJ,EAAeK,UAAfD,EAAwBE,eAAe,CAAEC,SAAU,UAIrC,EACb,CAACb,IAEJ,MAoCMc,EAAS,CACbC,UAAW,CACTC,SAAU,QACVC,OAAQ,OACRC,MAAO,OACPC,OAAQ,IAEVC,cAAe,CACbC,SAAU,QACVC,UAAW,QACXC,gBAAiB,QACjBC,aAAc,UACdC,UAAW,+BACXC,SAAU,SACVP,OAAQ,IAEVQ,OAAQ,CACNC,QAAS,OACTC,WAAY,SACZC,eAAgB,MAChBC,QAAS,WAEXC,YAAa,CACXC,OAAQ,UACRC,WAAY,6BACZ,SAAU,CACRC,UAAW,gBAGfC,kBAAmB,CACjBC,OAAQ,QACRC,UAAW,OACXP,QAAS,QAEXQ,eAAiBC,IAAqB,CACpCC,aAAc,UACdb,QAAS,OACTE,eAAgBU,EAAS,WAAa,eAExCE,QAAUF,IAAe,CACvBnB,SAAU,MACVG,aAAc,OACdO,QAAS,eACTR,gBAAiBiB,EAAS,UAAY,UACtCG,MAAOH,EAAS,QAAU,UAE5BI,WAAY,CACVC,UAAW,SACXF,MAAO,WAETG,eAAgB,CACdlB,QAAS,OACTC,WAAY,SACZkB,IAAK,SACLhB,QAAS,SACTiB,UAAW,qBAEbC,MAAO,CACLC,SAAU,EACVnB,QAAS,UACTP,aAAc,SACd2B,OAAQ,oBACRC,QAAS,OACT,SAAU,CACRC,YAAa,YAGjBC,WAAY,CACV/B,gBAAiB,UACjBoB,MAAO,QACPnB,aAAc,SACd,SAAU,CACRD,gBAAiB,YAGrBgC,WAAY,CACVhC,gBAAiB,UACjBoB,MAAO,QACPZ,QAAS,SACTP,aAAc,SACdC,UAAW,+BACX,SAAU,CACRF,gBAAiB,YAGrBiC,YAAa,CACXC,MAAO,SACPpB,OAAQ,UAEVqB,aAAc,CACZ9B,QAAS,OACTC,WAAY,SACZkB,IAAK,SACLhB,QAAS,SACTiB,UAAW,sBAIf,OACEW,EAAKC,cAAA,MAAA,CAAAC,MAAO/C,EAAOC,WACjB4C,EAAAC,cAACE,EAAO,CAAC9C,SAAS,cACjBnB,EACC8D,uBAAKE,MAAO/C,EAAOM,eACjBuC,EAAAC,cAAA,MAAA,CAAKC,MAAO/C,EAAOa,QACjBgC,EAAAC,cAAA,SAAA,CAAQG,QAASA,IAAMjE,GAAU,GAAQkE,UAAU,gBACjDL,EAACC,cAAAK,GACCJ,MAAO/C,EAAOkB,gBAKpB2B,EAAAC,cAAA,MAAA,CAAKC,MAAO/C,EAAOsB,mBAChBpC,EAASkE,IAAI,CAACxB,EAASyB,IACtBR,EACEC,cAAA,MAAA,CAAAQ,IAAKD,EACLN,MAAO/C,EAAOyB,eAAgC,SAAjBG,EAAQ2B,OAErCV,EAAAC,cAAA,MAAA,CAAKC,MAAO/C,EAAO4B,QAAyB,SAAjBA,EAAQ2B,OAChC3B,EAAQ4B,WAIdlE,GACCuD,EAAAC,cAAA,MAAA,CAAKC,MAAO/C,EAAOyB,gBAAe,IAChCoB,EAAKC,cAAA,MAAA,CAAAC,MAAO/C,EAAO4B,SAAQ,IAAuB,cAGtDiB,EAAAC,cAAA,MAAA,CAAKW,IAAKjE,KAGZqD,EACEC,cAAA,OAAA,CAAAY,SAvKgBC,UAExB,GADAC,EAAEC,kBACGzE,EAAa0E,OAAQ,OAE1B,MAAMC,EAAa,CAAER,KAAM,OAAQC,QAASpE,GAC5CD,EAAY,IAAID,EAAU6E,IAC1B1E,EAAgB,IAChBE,GAAa,GAEb,IACE,MAAMyE,QAAiBC,MAAM,GAAGpF,WAAiB,CAC/CqF,OAAQ,OACRC,QAAS,CACP,eAAgB,mBAChB,YAAarF,GAEfsF,KAAMC,KAAKC,UAAU,CACnBC,UAAWnF,EACXR,OAAQA,MAIZ,IAAKoF,EAASQ,GAAI,MAAU,IAAAC,MAAM,0BAElC,MAAMC,QAAaV,EAASW,OAC5BxF,EAAayF,GAAS,IACjBA,EACH,CAAErB,KAAM,YAAaC,QAASkB,EAAKV,WAEvC,CAAE,MAAOa,GACPC,EAAMD,MAAM,yBACd,CAAC,QACCtF,GAAa,EACf,GAuIQwD,MAAO/C,EAAOgC,gBAEda,EAAAC,cAAA,MAAA,CAAKC,MAAO/C,EAAO4C,cACjBC,EAAAC,cAAA,QAAA,CACEiC,KAAK,OACLC,MAAO5F,EACP6F,SAAWrB,GAAMvE,EAAgBuE,EAAEsB,OAAOF,OAC1CG,YAAY,uBACZpC,MAAO/C,EAAOmC,QAEhBU,EAAAC,cAAA,SAAA,CACEiC,KAAK,SACLK,SAAU9F,EACVyD,MAAO/C,EAAOwC,YAEdK,EAAAC,cAACuC,EAAW,CAACtC,MAAO/C,EAAOwC,iBAMnCK,EAAQC,cAAA,SAAA,CAAAG,QAASA,IAAMjE,GAAU,GAAOkE,UAAU,eAChDL,EAAAC,cAACwC,EAAS,CAACvC,MAAO/C,EAAO0C,eAE5B"}